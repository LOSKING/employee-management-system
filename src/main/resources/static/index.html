<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>员工管理系统</title>
    <!-- 引入Element UI样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- 自定义样式 -->
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;
        }
        .app-container {
            padding: 20px;
        }
        .header {
            background-color: #409EFF;
            color: white;
            padding: 15px 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header-title {
            margin: 0;
        }
        .user-info {
            display: flex;
            align-items: center;
            color: white;
        }
        .user-info span {
            margin-right: 15px;
        }
        .search-form {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #EBEEF5;
            background-color: #f5f7fa;
        }
        .toolbar {
            margin-bottom: 20px;
        }
        .pagination {
            margin-top: 20px;
            text-align: right;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="header">
            <h2 class="header-title">员工管理系统</h2>
            <div class="user-info" v-if="userInfo">
                <span>{{ userInfo.role === 'ADMIN' ? '管理员' : '员工' }}: {{ userInfo.username }}</span>
                <el-button type="text" style="color: white" @click="logout">退出登录</el-button>
            </div>
        </div>
        
        <div class="app-container">
            <!-- 搜索表单 -->
            <div class="search-form">
                <el-form :inline="true" :model="searchForm" ref="searchForm">
                    <el-form-item label="姓名">
                        <el-input v-model="searchForm.name" placeholder="请输入姓名" clearable></el-input>
                    </el-form-item>
                    <el-form-item label="部门">
                        <el-select v-model="searchForm.departmentId" placeholder="请选择部门" clearable>
                            <el-option v-for="item in departments" :key="item.id" :label="item.name" :value="item.id"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item label="职位">
                        <el-select v-model="searchForm.positionId" placeholder="请选择职位" clearable>
                            <el-option v-for="item in positions" :key="item.id" :label="item.name" :value="item.id"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item>
                        <el-button type="primary" @click="searchEmployees">查询</el-button>
                        <el-button @click="resetSearch">重置</el-button>
                    </el-form-item>
                </el-form>
            </div>
            
            <!-- 工具栏 -->
            <div class="toolbar" v-if="userInfo && userInfo.role === 'ADMIN'">
                <el-button type="primary" @click="showAddDialog">新增员工</el-button>
            </div>
            
            <!-- 员工表格 -->
            <el-table :data="employees" border style="width: 100%" v-loading="loading">
                <!-- 移除了ID列的显示 -->
                <el-table-column prop="name" label="姓名" width="120"></el-table-column>
                <el-table-column label="性别" width="80">
                    <template slot-scope="scope">
                        <span v-if="scope.row.gender === 1">男</span>
                        <span v-else-if="scope.row.gender === 2">女</span>
                        <span v-else>未知</span>
                    </template>
                </el-table-column>
                <el-table-column prop="age" label="年龄" width="80"></el-table-column>
                <el-table-column prop="phone" label="手机号" width="120"></el-table-column>
                <el-table-column prop="email" label="邮箱" width="180"></el-table-column>
                <el-table-column prop="departmentName" label="部门" width="120"></el-table-column>
                <el-table-column prop="positionName" label="职位" width="120"></el-table-column>
                <el-table-column prop="entryDate" label="入职日期" width="120"></el-table-column>
                <el-table-column label="状态" width="100">
                    <template slot-scope="scope">
                        <el-tag :type="scope.row.status === 1 ? 'success' : 'info'">
                            {{ scope.row.status === 1 ? '在职' : '离职' }}
                        </el-tag>
                    </template>
                </el-table-column>
                <el-table-column label="操作" width="200" v-if="userInfo && userInfo.role === 'ADMIN'">
                    <template slot-scope="scope">
                        <el-button size="mini" @click="showEditDialog(scope.row)">编辑</el-button>
                        <el-button size="mini" type="danger" @click="handleDelete(scope.row.id)">删除</el-button>
                    </template>
                </el-table-column>
            </el-table>
            
            <!-- 分页 -->
            <div class="pagination">
                <el-pagination
                    @size-change="handleSizeChange"
                    @current-change="handleCurrentChange"
                    :current-page="currentPage"
                    :page-sizes="[10, 20, 50, 100]"
                    :page-size="pageSize"
                    layout="total, sizes, prev, pager, next, jumper"
                    :total="total">
                </el-pagination>
            </div>
            
            <!-- 添加/编辑员工对话框 -->
            <el-dialog :title="dialogTitle" :visible.sync="dialogVisible" width="50%">
                <el-form :model="employeeForm" :rules="rules" ref="employeeForm" label-width="100px">
                    <el-form-item label="姓名" prop="name">
                        <el-input v-model="employeeForm.name"></el-input>
                    </el-form-item>
                    <el-form-item label="性别" prop="gender">
                        <el-radio-group v-model="employeeForm.gender">
                            <el-radio :label="1">男</el-radio>
                            <el-radio :label="2">女</el-radio>
                        </el-radio-group>
                    </el-form-item>
                    <el-form-item label="年龄" prop="age">
                        <el-input-number v-model="employeeForm.age" :min="18" :max="65"></el-input-number>
                    </el-form-item>
                    <el-form-item label="身份证号" prop="idCard">
                        <el-input v-model="employeeForm.idCard"></el-input>
                    </el-form-item>
                    <el-form-item label="手机号" prop="phone">
                        <el-input v-model="employeeForm.phone"></el-input>
                    </el-form-item>
                    <el-form-item label="邮箱" prop="email">
                        <el-input v-model="employeeForm.email"></el-input>
                    </el-form-item>
                    <el-form-item label="地址" prop="address">
                        <el-input v-model="employeeForm.address"></el-input>
                    </el-form-item>
                    <el-form-item label="部门" prop="departmentId">
                        <el-select v-model="employeeForm.departmentId" placeholder="请选择部门">
                            <el-option v-for="item in departments" :key="item.id" :label="item.name" :value="item.id"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item label="职位" prop="positionId">
                        <el-select v-model="employeeForm.positionId" placeholder="请选择职位">
                            <el-option v-for="item in positions" :key="item.id" :label="item.name" :value="item.id"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item label="入职日期" prop="entryDate">
                        <el-date-picker v-model="employeeForm.entryDate" type="date" placeholder="选择日期" value-format="yyyy-MM-dd"></el-date-picker>
                    </el-form-item>
                    <el-form-item label="状态" prop="status">
                        <el-radio-group v-model="employeeForm.status">
                            <el-radio :label="1">在职</el-radio>
                            <el-radio :label="0">离职</el-radio>
                        </el-radio-group>
                    </el-form-item>
                </el-form>
                <div slot="footer" class="dialog-footer">
                    <el-button @click="dialogVisible = false">取 消</el-button>
                    <el-button type="primary" @click="submitForm">确 定</el-button>
                </div>
            </el-dialog>
        </div>
    </div>

    <!-- 引入Vue.js -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <!-- 引入Element UI -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <!-- 引入Axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- 应用脚本 -->
    <script src="js/app.js"></script>
</body>
</html>